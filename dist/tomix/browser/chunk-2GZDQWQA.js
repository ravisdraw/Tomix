import{a as le}from"./chunk-YBM54P4T.js";import{C as pe,D as ge,F as he,G as fe,H as _e,a as te,h as ne,m as ie,n as oe,p as ae,q as y,r as re,s as de,t as se,u as me,v as ce,x as ue,y as xe}from"./chunk-ODYORDEL.js";import{$ as k,Aa as H,B as v,Ba as K,Ea as J,Ga as Q,Ha as I,J as s,M as B,N as Y,Qa as X,R as N,Ra as Z,Va as ee,W as h,X as f,Y as A,_ as F,aa as D,ba as o,ca as i,da as x,ha as R,ia as T,ja as _,la as c,pa as O,ra as S,sa as V,t as P,ta as l,u as p,ua as L,v as g,va as u,xa as z,ya as W,za as G}from"./chunk-5JVNEETK.js";var ye=()=>[1,2,3],ve=(r,n)=>n.id;function Se(r,n){if(r&1&&x(0,"i",75),r&2){let e=c(2);S("bx-chevron-up",e.sortDirection()==="desc")("bx-chevron-down",e.sortDirection()==="asc")}}function Ee(r,n){if(r&1&&x(0,"i",75),r&2){let e=c(2);S("bx-chevron-up",e.sortDirection()==="desc")("bx-chevron-down",e.sortDirection()==="asc")}}function Ie(r,n){if(r&1&&x(0,"i",75),r&2){let e=c(2);S("bx-chevron-up",e.sortDirection()==="desc")("bx-chevron-down",e.sortDirection()==="asc")}}function Le(r,n){if(r&1&&x(0,"i",75),r&2){let e=c(2);S("bx-chevron-up",e.sortDirection()==="desc")("bx-chevron-down",e.sortDirection()==="asc")}}function Me(r,n){if(r&1&&x(0,"i",75),r&2){let e=c(2);S("bx-chevron-up",e.sortDirection()==="desc")("bx-chevron-down",e.sortDirection()==="asc")}}function Ce(r,n){if(r&1&&x(0,"i",75),r&2){let e=c(2);S("bx-chevron-up",e.sortDirection()==="desc")("bx-chevron-down",e.sortDirection()==="asc")}}function we(r,n){if(r&1){let e=T();o(0,"div",24)(1,"button",72),_("click",function(){p(e);let a=c();return g(a.setSortField("monthlyDueDate"))}),o(2,"span"),l(3,"Due Date"),i(),h(4,Se,1,4,"i",73),i(),o(5,"button",72),_("click",function(){p(e);let a=c();return g(a.setSortField("paidMonths"))}),o(6,"span"),l(7,"Paid Months"),i(),h(8,Ee,1,4,"i",73),i(),o(9,"button",72),_("click",function(){p(e);let a=c();return g(a.setSortField("outstanding"))}),o(10,"span"),l(11,"Outstanding"),i(),h(12,Ie,1,4,"i",73),i(),o(13,"button",72),_("click",function(){p(e);let a=c();return g(a.setSortField("monthlyEMI"))}),o(14,"span"),l(15,"Monthly EMI"),i(),h(16,Le,1,4,"i",73),i(),o(17,"button",72),_("click",function(){p(e);let a=c();return g(a.setSortField("totalEMI"))}),o(18,"span"),l(19,"Total Loan Amount"),i(),h(20,Me,1,4,"i",73),i(),o(21,"button",74),_("click",function(){p(e);let a=c();return g(a.setSortField("interest"))}),o(22,"span"),l(23,"Interest Rate"),i(),h(24,Ce,1,4,"i",73),i()()}if(r&2){let e=c();s(4),f(e.sortField()==="monthlyDueDate"?4:-1),s(4),f(e.sortField()==="paidMonths"?8:-1),s(4),f(e.sortField()==="outstanding"?12:-1),s(4),f(e.sortField()==="monthlyEMI"?16:-1),s(4),f(e.sortField()==="totalEMI"?20:-1),s(4),f(e.sortField()==="interest"?24:-1)}}function De(r,n){r&1&&R(0)}function Te(r,n){if(r&1&&N(0,De,1,0,"ng-container",76),r&2){c();let e=O(145);D("ngTemplateOutlet",e)}}function Fe(r,n){r&1&&(o(0,"div",26),l(1," No Loan Data Available "),i())}function ke(r,n){if(r&1){let e=T();o(0,"div",87)(1,"i",88),_("click",function(a){p(e);let m=c().$implicit;return c(2).toggleEMISchedule(m),g(a.stopPropagation())}),i(),o(2,"i",89),_("click",function(a){p(e);let m=c().$implicit;return c(2).editLoan(m),g(a.stopPropagation())}),i(),o(3,"i",90),_("click",function(a){p(e);let m=c().$implicit;return c(2).deleteLoan(m.id),g(a.stopPropagation())}),i()()}}function Pe(r,n){if(r&1){let e=T();o(0,"div",78),_("click",function(){let a=p(e).$implicit,m=c(2);return g(m.toggleLoanSelection(a.id))}),o(1,"div",79)(2,"div",80)(3,"input",81),_("change",function(a){let m=p(e).$implicit,d=c(2);return g(d.toggleLoanCheckbox(m.id,a))}),i(),o(4,"div",82),l(5),i(),o(6,"div",11)(7,"div",83),l(8),i(),o(9,"div",84),l(10),i()()(),o(11,"div",85)(12,"div",86),l(13),i(),o(14,"div",84),l(15," Outstanding: "),o(16,"span",16),l(17),i()()()(),h(18,ke,4,0,"div",87),i()}if(r&2){let e=n.$implicit,t=c(2);s(),S("opacity-40",t.selectedLoanId()===e.id),s(2),D("checked",t.isLoanSelected(e.id)),s(2),L(e.emoji||"\u{1F4B0}"),s(3),L(e.loanName),s(2),W(" EMI: \u20B9",t.formatIndianRupee(e.monthlyEMI)," | Interest: ",e.interest,"% | Paid Months: ",e.paidMonths,"/",e.totalTenure," | Due Date: ",e.monthlyDueDate," "),s(3),u(" Rs. ",t.formatIndianRupee(t.calculateTotalLoanAmount(e.monthlyEMI,e.interest,e.totalTenure))," "),s(4),u("\u20B9",t.formatIndianRupee(t.calculateRemainingAmount(e.monthlyEMI,e.interest,e.totalTenure-e.paidMonths))),s(),f(t.selectedLoanId()===e.id?18:-1)}}function Be(r,n){if(r&1&&F(0,Pe,19,13,"div",77,ve),r&2){let e=c();k(e.sortedLoanItems())}}function Ne(r,n){r&1&&R(0)}function Ve(r,n){if(r&1&&N(0,Ne,1,0,"ng-container",76),r&2){c();let e=O(145);D("ngTemplateOutlet",e)}}function Ae(r,n){r&1&&(o(0,"div",31),l(1," No loan dues in next 7 days "),i())}function Re(r,n){if(r&1&&(o(0,"div",91)(1,"div",79)(2,"div",92)(3,"div",82),l(4),i(),o(5,"div",11)(6,"div",93),l(7),i(),o(8,"div",84),l(9),i()()(),o(10,"div",85)(11,"div",94),l(12),i(),o(13,"div",95),l(14),i(),o(15,"div",84),l(16),i()()()()),r&2){let e=n.$implicit,t=c(2);s(4),L(e.emoji||"\u{1F4B0}"),s(3),L(e.loanName),s(2),z(" EMI: \u20B9",t.formatIndianRupee(e.monthlyEMI)," | ",e.paidMonths,"/",e.totalTenure," "),s(3),u(" \u20B9",t.formatIndianRupee(e.monthlyEMI)," "),s(),V(t.calculateDaysLeftForLoan(e.monthlyDueDate)<=2?"text-red-500":"text-[#08B783]"),s(),u(" ",t.getDaysLeftText(t.calculateDaysLeftForLoan(e.monthlyDueDate))," "),s(2),u(" Due: ",t.getNextLoanDueDate(e.monthlyDueDate)," ")}}function Oe(r,n){if(r&1&&F(0,Re,17,10,"div",91,ve),r&2){let e=c();k(e.upcomingLoansDue())}}function je(r,n){if(r&1){let e=T();o(0,"input",138),K("ngModelChange",function(a){p(e);let m=c().$implicit;return H(m.extraPayment,a)||(m.extraPayment=a),g(a)}),_("change",function(){p(e);let a=c().$index,m=c(2);return g(m.recalculateSchedule(a))}),i()}if(r&2){let e=c().$implicit;G("ngModel",e.extraPayment)}}function $e(r,n){r&1&&(o(0,"span",135),l(1,"-"),i())}function qe(r,n){if(r&1&&(o(0,"tr",128)(1,"td",129),l(2),i(),o(3,"td",130),l(4),i(),o(5,"td",131),l(6),i(),o(7,"td",132),l(8),i(),o(9,"td",124),l(10),i(),o(11,"td",125),l(12),i(),o(13,"td",133),h(14,je,1,1,"input",134)(15,$e,2,0,"span",135),i(),o(16,"td",136),l(17),i(),o(18,"td",137),l(19),i()()),r&2){let e=n.$implicit,t=c(2);S("bg-green-50",e.isPaid),s(2),L(e.monthNumber),s(2),L(e.monthYear),s(2),u("\u20B9",t.formatIndianRupee(e.openingBalance)),s(2),u("\u20B9",t.formatIndianRupee(e.emi)),s(2),u("\u20B9",t.formatIndianRupee(e.interest)),s(2),u("\u20B9",t.formatIndianRupee(e.principal)),s(2),f(e.isPaid?15:14),s(3),u("\u20B9",t.formatIndianRupee(e.totalPrincipal)),s(),S("text-green-600",e.closingBalance===0)("text-gray-800",e.closingBalance>0),s(),u(" \u20B9",t.formatIndianRupee(e.closingBalance)," ")}}function Ue(r,n){if(r&1){let e=T();o(0,"div",46)(1,"div",96)(2,"div",97)(3,"div",98),x(4,"i",99),i(),o(5,"div")(6,"h2",100),l(7,"EMI Payment Schedule"),i(),o(8,"p",101),l(9),i()()(),o(10,"button",102),_("click",function(){p(e);let a=c();return g(a.closeEMISchedule())}),l(11,"\u2715"),i()(),o(12,"div",103)(13,"div",104)(14,"strong"),l(15,"Note:"),i(),l(16," EMI = Interest + Principal. Only the Principal amount reduces your loan balance. Interest is the cost of borrowing. "),i(),o(17,"div",105)(18,"div")(19,"div",106),l(20,"Monthly EMI"),i(),o(21,"div",107),l(22),i()(),o(23,"div")(24,"div",106),l(25,"Total Loan"),i(),o(26,"div",108),l(27),i()(),o(28,"div")(29,"div",106),l(30,"Interest Rate"),i(),o(31,"div",109),l(32),i()(),o(33,"div")(34,"div",106),l(35,"Remaining"),i(),o(36,"div",110),l(37),i()()()(),o(38,"div",111)(39,"div",112)(40,"div",113)(41,"table",114)(42,"thead")(43,"tr",115)(44,"th",116),l(45,"#"),i(),o(46,"th",117),l(47,"Month-Year"),i(),o(48,"th",118),l(49,"Opening Balance"),i(),o(50,"th",118),l(51,"EMI"),i(),o(52,"th",118),l(53,"Interest"),i(),o(54,"th",118),l(55,"Principal"),i(),o(56,"th",118),l(57,"Extra Payment"),i(),o(58,"th",118),l(59,"Total Principal"),i(),o(60,"th",119),l(61,"Closing Balance"),i()()(),o(62,"tbody"),F(63,qe,20,15,"tr",120,A),i(),o(65,"tfoot")(66,"tr",121)(67,"td",122),l(68,"Totals:"),i(),o(69,"td",123),l(70),i(),o(71,"td",124),l(72),i(),o(73,"td",125),l(74),i(),o(75,"td",126),l(76),i(),o(77,"td",126),l(78),i(),x(79,"td",127),i()()()()()()()}if(r&2){let e,t=c();s(9),L((e=t.selectedLoanForSchedule())==null?null:e.loanName),s(13),u("\u20B9",t.formatIndianRupee(t.selectedLoanForSchedule().monthlyEMI)),s(5),u("\u20B9",t.formatIndianRupee(t.calculateTotalLoanAmount(t.selectedLoanForSchedule().monthlyEMI,t.selectedLoanForSchedule().interest,t.selectedLoanForSchedule().totalTenure))),s(5),u("",t.selectedLoanForSchedule().interest,"% p.a."),s(5),u("",t.selectedLoanForSchedule().totalTenure-t.selectedLoanForSchedule().paidMonths," months"),s(26),k(t.emiSchedule()),s(7),u("\u20B9",t.formatIndianRupee(t.getTotalEMI())),s(2),u("\u20B9",t.formatIndianRupee(t.getTotalInterestPaid())),s(2),u("\u20B9",t.formatIndianRupee(t.getTotalPrincipalPaid())),s(2),u("\u20B9",t.formatIndianRupee(t.getTotalExtraPayment())),s(2),u("\u20B9",t.formatIndianRupee(t.getTotalPrincipalWithExtra()))}}function Ye(r,n){r&1&&(o(0,"p",57),l(1,"Loan name is required"),i())}function ze(r,n){r&1&&(o(0,"p",57),l(1,"Monthly EMI is required and must be greater than 0"),i())}function We(r,n){r&1&&(o(0,"p",57),l(1,"Interest rate is required"),i())}function Ge(r,n){r&1&&(o(0,"p",57),l(1,"Required"),i())}function He(r,n){r&1&&(o(0,"p",57),l(1,"Required"),i())}function Ke(r,n){if(r&1&&(o(0,"div",67)(1,"div",139),l(2,"Loan Summary"),i(),o(3,"div",140)(4,"div")(5,"div",141),l(6,"Total Loan Amount"),i(),o(7,"div",142),l(8),i()(),o(9,"div")(10,"div",141),l(11,"Total Interest"),i(),o(12,"div",143),l(13),i()(),o(14,"div")(15,"div",141),l(16,"Remaining Amount"),i(),o(17,"div",144),l(18),i()(),o(19,"div")(20,"div",141),l(21,"Remaining Months"),i(),o(22,"div",145),l(23),i()()()()),r&2){let e,t,a,m,d=c();s(8),u("\u20B9",d.formatIndianRupee(d.calculateTotalLoanAmount((e=d.loanForm.get("monthlyEMI"))==null?null:e.value,(e=d.loanForm.get("interest"))==null?null:e.value,(e=d.loanForm.get("totalTenure"))==null?null:e.value))),s(5),u("\u20B9",d.formatIndianRupee(d.calculateTotalInterest((t=d.loanForm.get("monthlyEMI"))==null?null:t.value,(t=d.loanForm.get("totalTenure"))==null?null:t.value,d.calculateTotalLoanAmount((t=d.loanForm.get("monthlyEMI"))==null?null:t.value,(t=d.loanForm.get("interest"))==null?null:t.value,(t=d.loanForm.get("totalTenure"))==null?null:t.value)))),s(5),u("\u20B9",d.formatIndianRupee(d.calculateRemainingAmount((a=d.loanForm.get("monthlyEMI"))==null?null:a.value,(a=d.loanForm.get("interest"))==null?null:a.value,((a=d.loanForm.get("totalTenure"))==null?null:a.value)-((a=d.loanForm.get("paidMonths"))==null?null:a.value)))),s(5),u("",((m=d.loanForm.get("totalTenure"))==null?null:m.value)-((m=d.loanForm.get("paidMonths"))==null?null:m.value)," months")}}function Je(r,n){r&1&&(o(0,"p",57),l(1,"Due date must be between 1 and 31"),i())}function Qe(r,n){r&1&&(o(0,"div",146)(1,"div",147)(2,"div",80)(3,"div",148),x(4,"div",149)(5,"div",150),i()(),o(6,"div",151),x(7,"div",152)(8,"div",153),i()()())}function Xe(r,n){r&1&&F(0,Qe,9,0,"div",146,A),r&2&&k(J(0,ye))}var be=class r{constructor(n,e,t){this.fb=n;this.authService=e;this.router=t;this.authService.session$.subscribe(a=>{a||this.router.navigate(["/login"])}),this.loanForm=this.fb.group({loanName:["",y.required],emoji:["\u{1F4B0}"],monthlyEMI:[0,[y.required,y.min(1)]],interest:[0,[y.required,y.min(0)]],totalTenure:[0,[y.required,y.min(1)]],paidMonths:[0,[y.required,y.min(0)]],monthlyDueDate:[1,[y.required,y.min(1),y.max(31)]]})}showAddLoan=v(!1);selectedLoanId=v(null);editingLoanId=v(null);isCheckingData=v(!0);loanForm;userId=v(null);selectedLoansForCheckbox=v(new Set);sortField=v("monthlyDueDate");sortDirection=v("asc");sortDropdownOpen=v(!1);showSchedule=v(!1);selectedLoanForSchedule=v(null);emiSchedule=v([]);appDataStore=P(ie);supabaseService=P(te);loansService=P(ne);loanItems=I(()=>this.appDataStore.loans());sortedLoanItems=I(()=>{let n=[...this.loanItems()],e=this.sortField(),t=this.sortDirection();return n.sort((a,m)=>{let d,b;switch(e){case"paidMonths":d=a.paidMonths||0,b=m.paidMonths||0;break;case"outstanding":d=this.calculateRemainingAmount(a.monthlyEMI,a.interest,a.totalTenure-a.paidMonths)||0,b=this.calculateRemainingAmount(m.monthlyEMI,m.interest,m.totalTenure-m.paidMonths)||0;break;case"monthlyEMI":d=a.monthlyEMI||0,b=m.monthlyEMI||0;break;case"totalEMI":d=this.calculateTotalLoanAmount(a.monthlyEMI,a.interest,a.totalTenure)||0,b=this.calculateTotalLoanAmount(m.monthlyEMI,m.interest,m.totalTenure)||0;break;case"interest":d=a.interest||0,b=m.interest||0;break;case"monthlyDueDate":default:d=a.monthlyDueDate||0,b=m.monthlyDueDate||0}return t==="asc"?d-b:b-d}),n});totalLoanAmount=I(()=>this.loanItems().reduce((n,e)=>n+(this.calculateTotalLoanAmount(e.monthlyEMI,e.interest,e.totalTenure)||0),0));upcomingLoansDue=I(()=>this.loanItems().filter(n=>{let e=this.calculateDaysLeftForLoan(n.monthlyDueDate);return e>=0&&e<=7}));totalSelectedEMI=I(()=>this.loanItems().filter(n=>this.selectedLoansForCheckbox().has(n.id)).reduce((n,e)=>n+(e.monthlyEMI||0),0));totalOutstandingAmount=I(()=>this.loanItems().filter(n=>this.selectedLoansForCheckbox().has(n.id)).reduce((n,e)=>n+(this.calculateRemainingAmount(e.monthlyEMI,e.interest,e.totalTenure-e.paidMonths)||0),0));totalOutstandingAmt=I(()=>this.loanItems().reduce((n,e)=>n+(this.calculateRemainingAmount(e.monthlyEMI,e.interest,e.totalTenure-e.paidMonths)||0),0));totalMonthlyEMI=I(()=>this.loanItems().reduce((n,e)=>n+(e.monthlyEMI||0),0));async ngOnInit(){try{let n=await this.supabaseService.getCurrentUser();n&&(this.userId.set(n.id),await this.loadLoans(n.id))}catch(n){console.error("Failed to get user:",n);let e=this.getOrCreateDemoUserId();this.userId.set(e),await this.loadLoans(e)}}getOrCreateDemoUserId(){let n="demo-user-id",e=localStorage.getItem(n);return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let a=Math.random()*16|0;return(t==="x"?a:a&3|8).toString(16)}),localStorage.setItem(n,e)),e}async loadLoans(n){this.isCheckingData.set(!0);try{this.appDataStore.loansLoaded()&&this.appDataStore.currentUserId()===n?console.log("Using cached loans data"):await this.appDataStore.loadLoans(n)}catch(e){console.error("Error loading loans:",e)}finally{this.isCheckingData.set(!1)}}openAddLoan(){this.editingLoanId.set(null),this.selectedLoanId.set(null),this.loanForm.reset({loanName:"",emoji:"\u{1F4B0}",monthlyEMI:0,interest:0,totalTenure:0,paidMonths:0,monthlyDueDate:1}),this.showAddLoan.set(!0)}toggleLoanSelection(n){this.selectedLoanId()===n?this.selectedLoanId.set(null):this.selectedLoanId.set(n)}toggleLoanCheckbox(n,e){e.stopPropagation();let t=new Set(this.selectedLoansForCheckbox());t.has(n)?t.delete(n):t.add(n),this.selectedLoansForCheckbox.set(t)}isLoanSelected(n){return this.selectedLoansForCheckbox().has(n)}editLoan(n){this.editingLoanId.set(n.id),this.loanForm.patchValue({loanName:n.loanName,emoji:n.emoji,monthlyEMI:n.monthlyEMI,interest:n.interest,totalTenure:n.totalTenure,paidMonths:n.paidMonths,monthlyDueDate:n.monthlyDueDate}),this.showAddLoan.set(!0)}async saveLoan(){if(this.loanForm.invalid)return;let n=this.userId();if(!n){console.error("User ID not set");return}try{let e=this.loanForm.value,t=this.editingLoanId();t?await this.loansService.updateLoan(t,e):await this.loansService.saveLoan(e),this.closeLoanForm(),await this.appDataStore.loadLoans(n),await this.loadLoans(n)}catch(e){console.error("Error saving loan:",e)}}async deleteLoan(n){if(confirm("Are you sure you want to delete this loan?"))try{await this.loansService.deleteLoan(n);let e=this.userId();e&&(await this.appDataStore.loadLoans(e),await this.loadLoans(e))}catch(e){console.error("Error deleting loan:",e)}}closeLoanForm(){this.showAddLoan.set(!1),this.editingLoanId.set(null),this.selectedLoanId.set(null),this.loanForm.reset()}toggleEMISchedule(n){this.showSchedule()&&this.selectedLoanForSchedule()?.id===n.id?this.closeEMISchedule():(this.selectedLoanForSchedule.set(n),this.generateEMISchedule(n),this.showSchedule.set(!0))}closeEMISchedule(){this.showSchedule.set(!1),this.selectedLoanForSchedule.set(null),this.emiSchedule.set([])}generateEMISchedule(n){let e=[],t=n.interest/12/100,a=this.calculateTotalLoanAmount(n.monthlyEMI,n.interest,n.totalTenure),m=this.calculateRemainingAmount(n.monthlyEMI,n.interest,n.totalTenure-n.paidMonths),d=new Date,b=n.paidMonths,M=n.totalTenure-n.paidMonths;for(let E=0;E<M;E++){let C=new Date(d);C.setMonth(d.getMonth()+E);let w=Math.round(m*t),j=Math.round(n.monthlyEMI-w),$=0,q=j+$,U=Math.max(0,Math.round(m-q));if(e.push({monthNumber:b+E+1,monthYear:C.toLocaleDateString("en-US",{month:"short",year:"numeric"}),openingBalance:Math.round(m),emi:n.monthlyEMI,interest:w,principal:j,extraPayment:$,totalPrincipal:q,closingBalance:U,isPaid:!1}),m=U,m<=0)break}this.emiSchedule.set(e)}recalculateSchedule(n){let e=[...this.emiSchedule()],t=this.selectedLoanForSchedule();if(!t)return;let a=t.interest/12/100;for(let m=n;m<e.length;m++){let d=e[m];m===n?(d.totalPrincipal=d.principal+(d.extraPayment||0),d.closingBalance=Math.max(0,Math.round(d.openingBalance-d.totalPrincipal))):(d.openingBalance=e[m-1].closingBalance,d.openingBalance<=0?(d.interest=0,d.principal=0,d.emi=0,d.extraPayment=0,d.totalPrincipal=0,d.closingBalance=0):(d.interest=Math.round(d.openingBalance*a),d.principal=Math.round(t.monthlyEMI-d.interest),d.totalPrincipal=d.principal+(d.extraPayment||0),d.closingBalance=Math.max(0,Math.round(d.openingBalance-d.totalPrincipal))))}this.emiSchedule.set(e)}getTotalEMI(){return this.emiSchedule().reduce((n,e)=>n+e.emi,0)}getTotalInterestPaid(){return this.emiSchedule().reduce((n,e)=>n+e.interest,0)}getTotalPrincipalPaid(){return this.emiSchedule().reduce((n,e)=>n+e.principal,0)}getTotalExtraPayment(){return this.emiSchedule().reduce((n,e)=>n+(e.extraPayment||0),0)}getTotalPrincipalWithExtra(){return this.emiSchedule().reduce((n,e)=>n+e.totalPrincipal,0)}formatIndianRupee(n){return n?n.toLocaleString("en-IN"):"0"}calculateTotalLoanAmount(n,e,t){if(!n||!t||n<=0||t<=0)return 0;if(e===0)return n*t;let a=e/12/100,m=n*(Math.pow(1+a,t)-1)/(a*Math.pow(1+a,t));return Math.round(m)}calculateRemainingAmount(n,e,t){return this.calculateTotalLoanAmount(n,e,t)}calculateTotalInterest(n,e,t){let a=n*e;return Math.round(a-t)}calculateMonthlyEMI(n,e,t){if(!n||!t||n<=0||t<=0)return 0;if(e===0)return n/t;let a=e/12/100,m=n*a*Math.pow(1+a,t)/(Math.pow(1+a,t)-1);return Math.round(m)}getTotalInterest(){return this.loanItems().reduce((e,t)=>e+(t.interest||0),0).toFixed(2)}getTotalTenure(){return this.loanItems().reduce((n,e)=>n+(e.totalTenure||0),0)}calculateDaysLeftForLoan(n){let e=new Date,t=e.getDate(),a=e.getMonth(),m=e.getFullYear(),d;t<=n?d=new Date(m,a,n):d=new Date(m,a+1,n);let b=d.getTime()-e.getTime();return Math.ceil(b/(1e3*60*60*24))}getDaysLeftText(n){return n===0?"Today":n===1?"Tomorrow":`${n} days`}getNextLoanDueDate(n){let e=new Date,t=e.getDate(),a=e.getMonth(),m=e.getFullYear(),d;return t<=n?d=new Date(m,a,n):d=new Date(m,a+1,n),d.toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})}setSortField(n){this.sortField()===n?this.sortDirection.set(this.sortDirection()==="asc"?"desc":"asc"):(this.sortField.set(n),this.sortDirection.set("asc")),this.sortDropdownOpen.set(!1)}toggleSortDropdown(){this.sortDropdownOpen.set(!this.sortDropdownOpen())}static \u0275fac=function(e){return new(e||r)(B(he),B(oe),B(ee))};static \u0275cmp=Y({type:r,selectors:[["app-loans"]],decls:146,vars:34,consts:[["skeletonLoader",""],[1,"w-full","h-full","flex","flex-col","2xl:px-8","px-5"],[1,"w-full","2xl:h-[10%]","h-[8%]","flex","place-items-center","justify-between"],[1,"font-medium","2xl:text-[25px]","text-[22px]"],[1,"flex","gap-3","justify-center","place-items-center"],[1,"p-3","justify-center","place-items-center"],[1,"bx","bx-plus","rounded-[10px]","bg-[#08B783]","p-3","2xl:text-[20px]","text-[16px]","font-bold",2,"color","#ffffff",3,"click"],[1,"w-full","h-[90%]","flex","flex-col","2xl:gap-5","gap-2","pb-5"],[1,"flex","2xl:gap-5","gap-2","flex-col","md:flex-row","h-full"],[1,"w-full","md:w-3/5","rounded-[10px]","bg-[#F7FCFC]","flex","flex-col","min-h-0"],[1,"w-full","flex-shrink-0","flex","place-items-center","justify-between","p-5","border-b","border-b-gray-200"],[1,"flex","flex-col","gap-1"],[1,"font-medium","2xl:text-[20px]","text-[16px]"],[1,"text-[10px]","text-gray-500","font-medium","italic"],[1,"flex","flex-col","gap-2","text-center","items-center","justify-center","px-4"],[1,"2xl:text-[18px]","text-[14px]","font-semibold"],[1,"text-[#08B783]"],[1,"text-gray-400","mx-1"],[1,"text-[#FC3134]"],[1,"text-[10px]","text-gray-500","font-medium","whitespace-nowrap"],[1,"relative","ml-4"],[1,"flex","items-center","gap-2","px-3","py-1","bg-white","border","border-gray-300","rounded-lg","text-[11px]","font-medium","hover:bg-gray-50","transition-colors",3,"click"],[1,"bx","bx-sort-alt"],[1,"bx"],[1,"absolute","right-0","top-full","mt-1","bg-white","border","border-gray-200","rounded-lg","shadow-lg","z-50","min-w-[160px]"],[1,"w-full","flex-1","flex","flex-col","border-t","border-t-gray-200","overflow-y-auto","min-h-0"],[1,"w-full","flex","place-items-center","h-full","justify-center","text-gray-400"],[1,"w-full","md:w-2/5","flex","flex-col","2xl:gap-5","gap-2","h-full","min-h-0"],[1,"w-full","rounded-[10px]","bg-[#F7FCFC]","flex","flex-col","flex-1","min-h-0"],[1,"font-medium","2xl:text-[18px]","text-[14px]","2xl:mb-4","mb-2","mt-2"],[1,"w-full","flex-1","flex","flex-col","overflow-y-auto","min-h-0"],[1,"w-full","flex","place-items-center","h-full","justify-center","text-gray-400","text-sm"],[1,"w-full","rounded-[10px]","bg-[#F7FCFC]","flex","flex-col","p-5","flex-shrink-0"],[1,"font-medium","2xl:text-[18px]","text-[14px]","2xl:mb-4","mb-2"],[1,"flex","flex-col","2xl:gap-3","gap-2"],[1,"flex","justify-between","place-items-center","2xl:p-3","p-2","bg-white","rounded-lg"],[1,"2xl:text-[12px]","text-[10px]","text-gray-500","font-medium"],[1,"font-semibold","2xl:text-[20px]","text-[16px]","text-[#08B783]"],[1,"2xl:p-3","p-2","bg-green-100","rounded-full"],[1,"bx","bx-dollar-circle","2xl:text-[20px]","text-[16px]",2,"color","#08B783"],[1,"font-semibold","2xl:text-[20px]","text-[16px]"],[1,"text-[9px]","text-gray-400","font-medium"],[1,"2xl:p-3","p-2","bg-red-100","rounded-full"],[1,"bx","bx-check-circle","2xl:text-[20px]","text-[16px]",2,"color","#FC3134"],[1,"2xl:p-3","p-2","bg-blue-100","rounded-full"],[1,"bx","bx-trending-up","2xl:text-[20px]","text-[16px]",2,"color","#2563eb"],[1,"w-full","rounded-[10px]","bg-white","border-2","border-[#08B783]","shadow-lg"],[1,"fixed","top-0","right-0","z-50","h-full","2xl:max-w-md","w-sm","bg-white","transform","transition-transform","duration-300","ease-in-out","flex","flex-col","translate-x-full"],[1,"flex","items-center","justify-between","p-4","border-b"],[1,"2xl:text-lg","font-semibold"],[1,"text-2xl","text-gray-500",3,"click"],[1,"flex","flex-col","2xl:gap-4","gap-2","p-4","overflow-y-auto","flex-1","2xl:text-[15px]","text-[12px]",3,"formGroup"],[1,"flex","gap-3"],[1,"flex-1"],[1,"text-sm","font-medium"],[1,"text-red-500"],["type","text","formControlName","loanName","placeholder","e.g., Home Loan, Car Loan",1,"mt-1","w-full","rounded-lg","border","px-3","py-2","outline-none"],[1,"text-red-500","text-xs","mt-1"],[1,"w-20"],[3,"emojiSelected","defaultEmoji"],[1,"relative"],[1,"absolute","left-3","top-3","text-gray-500"],["type","number","formControlName","monthlyEMI","placeholder","0",1,"mt-1","w-full","rounded-lg","border","px-10","py-2","outline-none"],["type","number","formControlName","interest","step","0.01","placeholder","0",1,"mt-1","w-full","rounded-lg","border","px-3","py-2","outline-none"],[1,"grid","grid-cols-2","gap-3"],["type","number","formControlName","totalTenure","placeholder","0",1,"mt-1","w-full","rounded-lg","border","px-3","py-2","outline-none"],["type","number","formControlName","paidMonths","placeholder","0",1,"mt-1","w-full","rounded-lg","border","px-3","py-2","outline-none"],[1,"bg-gradient-to-br","from-blue-50","to-purple-50","p-4","rounded-lg","border","border-blue-200"],["type","number","formControlName","monthlyDueDate","min","1","max","31","placeholder","1",1,"mt-1","w-full","rounded-lg","border","px-3","py-2","outline-none"],[1,"mt-auto","flex","gap-3","pt-4"],["type","button",1,"flex-1","rounded-lg","bg-gray-200","py-2",3,"click"],["type","button",1,"flex-1","rounded-lg","bg-emerald-500","text-white","py-2","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"w-full","text-left","px-4","py-2","text-[11px]","hover:bg-gray-100","flex","items-center","justify-between","border-b","border-gray-100","transition-colors",3,"click"],[1,"bx","text-[14px]",3,"bx-chevron-up","bx-chevron-down"],[1,"w-full","text-left","px-4","py-2","text-[11px]","hover:bg-gray-100","flex","items-center","justify-between","transition-colors",3,"click"],[1,"bx","text-[14px]"],[4,"ngTemplateOutlet"],[1,"w-full","relative","px-5","2xl:py-3","py-2","cursor-pointer"],[1,"w-full","relative","px-5","2xl:py-3","py-2","cursor-pointer",3,"click"],[1,"w-full","flex","place-items-start","justify-between"],[1,"flex","gap-5","place-items-center","flex-1"],["type","checkbox",1,"w-4","h-4","cursor-pointer",3,"change","checked"],[1,"p-2","2xl:text-[20px]","text-[18px]","bg-gray-200","rounded-full"],[1,"font-medium","2xl:text-[18px]","text-[14px]"],[1,"text-[10px]","text-gray-500","font-medium"],[1,"flex","flex-col","gap-1","items-end"],[1,"font-semibold","2xl:text-[18px]","text-[14px]","text-[#FC3134]"],[1,"absolute","inset-0","flex","items-center","justify-center","gap-4"],["title","View EMI Schedule",1,"bx","bx-info-circle","bx-lg",2,"color","#0f1f3c","font-size","28px","cursor","pointer",3,"click"],[1,"bx","bx-edit-alt","bx-lg",2,"color","#0f1f3c","font-size","28px","cursor","pointer",3,"click"],[1,"bx","bx-trash-alt","bx-lg",2,"color","#0f1f3c","font-size","28px","cursor","pointer",3,"click"],[1,"w-full","px-5","2xl:py-3","py-2","border-b","border-b-gray-100"],[1,"flex","gap-3","place-items-center","flex-1"],[1,"font-medium","2xl:text-[16px]","text-[13px]"],[1,"font-semibold","2xl:text-[16px]","text-[13px]","text-[#FC3134]"],[1,"text-[11px]","font-medium"],[1,"flex","items-center","justify-between","p-4","border-b","bg-linear-to-r","from-[#08B783]/10","to-transparent"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-full","bg-[#08B783]","flex","items-center","justify-center"],[1,"bx","bx-calculator","text-white","text-[20px]"],[1,"2xl:text-[18px]","text-[16px]","font-semibold"],[1,"text-xs","text-gray-600"],[1,"text-2xl","text-gray-500","hover:bg-gray-100","rounded-full","w-8","h-8","flex","items-center","justify-center",3,"click"],[1,"p-4","bg-linear-to-br","from-blue-50","to-purple-50","border-b"],[1,"mb-3","p-2","bg-blue-100","rounded","text-xs","text-blue-800"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-3","text-sm"],[1,"text-gray-600","text-xs"],[1,"font-bold","text-[#08B783]"],[1,"font-bold","text-blue-600"],[1,"font-bold","text-orange-600"],[1,"font-bold","text-purple-600"],[1,"max-h-125","overflow-auto","p-4"],[1,"bg-white","rounded-lg"],[1,"overflow-x-auto"],[1,"w-full","2xl:text-[14px]","text-[12px]"],[1,"bg-gray-100"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-left","font-semibold","text-gray-700","rounded-tl-lg"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-left","font-semibold","text-gray-700"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","font-semibold","text-gray-700"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","font-semibold","text-gray-700","rounded-tr-lg"],[1,"border-t","border-gray-200","hover:bg-gray-50",3,"bg-green-50"],[1,"bg-gray-100","border-t-2","border-gray-300","font-bold"],["colspan","3",1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","rounded-bl-lg"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","text-[#08B783]"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","text-orange-600"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","text-blue-600"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","text-purple-600"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","rounded-br-lg"],[1,"border-t","border-gray-200","hover:bg-gray-50"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-gray-600"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-gray-800","font-medium"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","text-gray-800"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","font-semibold","text-[#08B783]"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right"],["type","number","placeholder","0",1,"w-20","px-2","py-1","border","rounded","text-right","outline-none","focus:border-[#08B783]",3,"ngModel"],[1,"text-gray-400"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","font-semibold","text-purple-600"],[1,"2xl:py-3","py-2","2xl:px-5","px-2","text-right","font-bold"],["type","number","placeholder","0",1,"w-20","px-2","py-1","border","rounded","text-right","outline-none","focus:border-[#08B783]",3,"ngModelChange","change","ngModel"],[1,"text-xs","font-semibold","text-gray-700","mb-2"],[1,"grid","grid-cols-2","gap-3","text-xs"],[1,"text-gray-500"],[1,"font-semibold","text-blue-600"],[1,"font-semibold","text-orange-600"],[1,"font-semibold","text-green-600"],[1,"font-semibold","text-purple-600"],[1,"skeleton-item"],[1,"flex","place-items-start","justify-between"],[1,"flex","flex-col","gap-2","flex-1"],[1,"skeleton","skeleton-title"],[1,"skeleton","skeleton-subtitle"],[1,"flex","flex-col","gap-2","items-end"],[1,"skeleton","skeleton-amount"],[1,"skeleton","skeleton-text"]],template:function(e,t){if(e&1){let a=T();o(0,"div",1)(1,"div",2)(2,"div",3),l(3,"Loans"),i(),o(4,"div",4)(5,"div",5)(6,"i",6),_("click",function(){return p(a),g(t.openAddLoan())}),i()()()(),o(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12),l(13,"Total Loan Amount"),i(),o(14,"div",13),l(15,'"Every payment is a step closer to freedom"'),i()(),o(16,"div",14)(17,"div",15)(18,"span",16),l(19),i(),o(20,"span",17),l(21,"/"),i(),o(22,"span",18),l(23),i()(),o(24,"div",19),l(25,"Total Loan Amount"),i()(),o(26,"div",20)(27,"button",21),_("click",function(){return p(a),g(t.toggleSortDropdown())}),x(28,"i",22),l(29," Sort "),x(30,"i",23),i(),h(31,we,25,6,"div",24),i()(),o(32,"div",25),h(33,Te,1,1,"ng-container")(34,Fe,2,0,"div",26)(35,Be,2,0),i()(),o(36,"div",27)(37,"div",28)(38,"div",10)(39,"div",29),l(40,"Upcoming Dues : Next 7 days"),i()(),o(41,"div",30),h(42,Ve,1,1,"ng-container")(43,Ae,2,0,"div",31)(44,Oe,2,0),i()(),o(45,"div",32)(46,"div",33),l(47,"EMI Summary"),i(),o(48,"div",34)(49,"div",35)(50,"div",11)(51,"div",36),l(52,"Total Monthly EMI"),i(),o(53,"div",37),l(54),i()(),o(55,"div",38),x(56,"i",39),i()(),o(57,"div",35)(58,"div",11)(59,"div",36),l(60,"Selected EMI (Monthly)"),i(),o(61,"div",40),l(62),i(),o(63,"div",41),l(64),i()(),o(65,"div",42),x(66,"i",43),i()(),o(67,"div",35)(68,"div",11)(69,"div",36),l(70,"Outstanding Amount"),i(),o(71,"div",40),l(72),i(),o(73,"div",41),l(74," Selected loans remaining "),i()(),o(75,"div",44),x(76,"i",45),i()()()()()(),h(77,Ue,80,10,"div",46),i()(),o(78,"div",47)(79,"div",48)(80,"h2",49),l(81),i(),o(82,"button",50),_("click",function(){return p(a),g(t.closeLoanForm())}),l(83,"\u2715"),i()(),o(84,"form",51)(85,"div",52)(86,"div",53)(87,"label",54),l(88,"Loan Name "),o(89,"span",55),l(90,"*"),i()(),x(91,"input",56),h(92,Ye,2,0,"p",57),i(),o(93,"div",58)(94,"label",54),l(95,"Emoji"),i(),o(96,"app-emoji-picker",59),_("emojiSelected",function(d){return p(a),g(t.loanForm.patchValue({emoji:d}))}),i()()(),o(97,"div")(98,"label",54),l(99,"Monthly EMI "),o(100,"span",55),l(101,"*"),i()(),o(102,"div",60)(103,"span",61),l(104,"\u20B9"),i(),x(105,"input",62),i(),h(106,ze,2,0,"p",57),i(),o(107,"div")(108,"label",54),l(109,"Interest Rate (%) "),o(110,"span",55),l(111,"*"),i()(),x(112,"input",63),h(113,We,2,0,"p",57),i(),o(114,"div",64)(115,"div")(116,"label",54),l(117,"Total Tenure "),o(118,"span",55),l(119,"*"),i()(),o(120,"div",60),x(121,"input",65),i(),h(122,Ge,2,0,"p",57),i(),o(123,"div")(124,"label",54),l(125,"Paid Months "),o(126,"span",55),l(127,"*"),i()(),o(128,"div",60),x(129,"input",66),i(),h(130,He,2,0,"p",57),i()(),h(131,Ke,24,4,"div",67),o(132,"div")(133,"label",54),l(134,"Monthly Due Date (1-31) "),o(135,"span",55),l(136,"*"),i()(),x(137,"input",68),h(138,Je,2,0,"p",57),i(),o(139,"div",69)(140,"button",70),_("click",function(){return p(a),g(t.closeLoanForm())}),l(141," Cancel "),i(),o(142,"button",71),_("click",function(){return p(a),g(t.saveLoan())}),l(143),i()()()(),N(144,Xe,2,1,"ng-template",null,0,Q)}if(e&2){let a,m,d,b,M,E,C,w;s(19),u("\u20B9",t.formatIndianRupee(t.totalOutstandingAmt())),s(4),u("\u20B9",t.formatIndianRupee(t.totalLoanAmount())),s(7),S("bx-chevron-down",!t.sortDropdownOpen())("bx-chevron-up",t.sortDropdownOpen()),s(),f(t.sortDropdownOpen()?31:-1),s(2),f(t.isCheckingData()?33:t.loanItems().length===0?34:35),s(9),f(t.isCheckingData()?42:t.upcomingLoansDue().length===0?43:44),s(12),u(" \u20B9",t.formatIndianRupee(t.totalMonthlyEMI())," "),s(7),V(t.totalSelectedEMI()===0?"text-gray-400":"text-[#FC3134]"),s(),u(" \u20B9",t.formatIndianRupee(t.totalSelectedEMI())," "),s(2),u(" ",t.selectedLoansForCheckbox().size," loan(s) selected "),s(7),V(t.totalOutstandingAmount()===0?"text-gray-400":"text-blue-600"),s(),u(" \u20B9",t.formatIndianRupee(t.totalOutstandingAmount())," "),s(5),f(t.showSchedule()&&t.selectedLoanForSchedule()?77:-1),s(),S("translate-x-0",t.showAddLoan())("translate-x-full",!t.showAddLoan()),s(3),u(" ",t.editingLoanId()?"Edit Loan":"Add New Loan"," "),s(3),D("formGroup",t.loanForm),s(8),f((a=t.loanForm.get("loanName"))!=null&&a.invalid&&((a=t.loanForm.get("loanName"))!=null&&a.touched)?92:-1),s(4),D("defaultEmoji",(m=t.loanForm.get("emoji"))==null?null:m.value),s(10),f((d=t.loanForm.get("monthlyEMI"))!=null&&d.invalid&&((d=t.loanForm.get("monthlyEMI"))!=null&&d.touched)?106:-1),s(7),f((b=t.loanForm.get("interest"))!=null&&b.invalid&&((b=t.loanForm.get("interest"))!=null&&b.touched)?113:-1),s(9),f((M=t.loanForm.get("totalTenure"))!=null&&M.invalid&&((M=t.loanForm.get("totalTenure"))!=null&&M.touched)?122:-1),s(8),f((E=t.loanForm.get("paidMonths"))!=null&&E.invalid&&((E=t.loanForm.get("paidMonths"))!=null&&E.touched)?130:-1),s(),f(((C=t.loanForm.get("monthlyEMI"))==null?null:C.value)>0&&((C=t.loanForm.get("totalTenure"))==null?null:C.value)>0?131:-1),s(7),f((w=t.loanForm.get("monthlyDueDate"))!=null&&w.invalid&&((w=t.loanForm.get("monthlyDueDate"))!=null&&w.touched)?138:-1),s(4),D("disabled",t.loanForm.invalid),s(),u(" ",t.editingLoanId()?"Update Loan":"Add Loan"," ")}},dependencies:[_e,me,ae,ce,re,de,ge,pe,xe,ue,fe,se,Z,X,le],styles:[`form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{border:1px solid lightgray}form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] > option[_ngcontent-%COMP%]{color:#000}.skeleton[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}.skeleton-item[_ngcontent-%COMP%]{padding:16px 20px;border-bottom:1px solid #e5e5e5}.skeleton-avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%}.skeleton-title[_ngcontent-%COMP%]{height:16px;margin-bottom:8px;border-radius:4px}.skeleton-subtitle[_ngcontent-%COMP%]{height:12px;width:60%;border-radius:4px}.skeleton-amount[_ngcontent-%COMP%]{height:20px;width:80px;border-radius:4px;margin-bottom:8px}.skeleton-text[_ngcontent-%COMP%]{height:12px;width:70px;border-radius:4px}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(100%)}to{transform:translate(0)}}.animate-slide-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-in-out}

`],changeDetection:0})};export{be as Loans};
